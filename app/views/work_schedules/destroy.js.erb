var work_dates_array=[];
var work_opts = [];
var nsel_opts = [];
var nsel_dates_array = [];
var enable = [];
var actv_opts = [];

$(".work_schedule_" + "<%= @work_schedule.work_days_time.id %>").remove()

$('#schedule_new_actual_select option:not(:selected)').each(function() {
  nsel_opts.push($(this).attr('value'));
});

$.each(nsel_opts, function(index, value) {
  var d, t;
  t = $('#' + value).parent().parent();

  d = [t.attr("days"), Date.parse(t.attr("start-time")), Date.parse(t.attr("end-time"))];
  d[1] = Date.parse(d[1]);
  d[2] = Date.parse(d[2]);
  nsel_dates_array.push(d);
});

work_date = ["<%= @work_schedule.work_days_time.days%>", Date.parse("<%= @work_schedule.work_days_time.start_time.strftime("%l:%M %p") %>"), Date.parse("<%= @work_schedule.work_days_time.end_time.strftime("%l:%M %p") %>")]

$.each(nsel_opts, function(index1, value1) {
    if (!(nsel_dates_array[index1][0].indexOf(work_date[0]) === -1)) {
      if (work_date[1] < nsel_dates_array[index1][2] && nsel_dates_array[index1][1] < work_date[2]) {
        enable.push(value1);
      }
    }
});

enable = $.unique(enable);

$.each(enable, function(index, value) {
  $('.' + value).parent().parent().removeAttr("hidden", "");
});

$(".category-items.incomplete-category").each(function() {
    var all_hidden = true;
    var categoryNode = $(this);

    categoryNode.find(".offering-div").each(function() {
        var count = $(this).find("paper-icon-item").length;
        var offeringCourseNode = $(this);
        offeringCourseNode.find("paper-icon-item").each(function() {
            if ($(this).attr('hidden')) {
                count--;
            }
        });
        if (count != 0) {
            $(offeringCourseNode.children()[0])[0].classList.remove("inactive");
            all_hidden = false;
        }
    });
    if (!all_hidden) {
        $(categoryNode.children()[1]).attr("hidden", '');
    }
});